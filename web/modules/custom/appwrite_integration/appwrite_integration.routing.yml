appwrite_integration.settings:
  path: '/admin/config/services/appwrite-integration'
  defaults:
    _form: '\Drupal\appwrite_integration\Form\AppwriteConfigForm'
    _title: 'Appwrite Integration Settings'
  requirements:
    _permission: 'administer site configuration'

# General login route that takes {provider} as a parameter
appwrite_integration.oauth_login:
  path: '/appwrite/{provider}/login'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AuthController::login'
    _title_callback: '\Drupal\appwrite_integration\Controller\AuthController::loginTitle'
  requirements:
    _permission: 'access content'
    provider: 'google|github'

# Dashboard
appwrite_integration.dashboard:
  path: '/appwrite/dashboard'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AuthController::dashboard'
    _title: 'Dashboard'
  requirements:
    _permission: 'access content'

# OAuth callback
appwrite_integration.auth_callback:
  path: '/appwrite/auth/callback'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AuthController::authCallback'
    _title: 'Authenticating…'
  requirements:
    _permission: 'access content'

# Logout (just a landing page; JS does the work)
appwrite_integration.logout:
  path: '/appwrite/logout'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AuthController::logout'
    _title: 'Logging out…'
  requirements:
    _permission: 'access content'

appwrite_integration.webhook.users:
  path: '/appwrite/webhook/users'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AppwriteWebhookController::handleUserWebhook'
  methods: [POST]
  requirements:
    _access: 'TRUE'

appwrite_integration.webhook.health:
  path: '/appwrite/webhook/health'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AppwriteWebhookController::healthCheck'
  methods: [GET]
  requirements:
    _access: 'TRUE'

appwrite_integration.finalize_login:
  path: '/appwrite/oauth/finalize-login'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AuthController::finalizeLogin'
  methods: [POST]
  requirements:
    _access: 'TRUE'

appwrite_integration.file_upload:
  path: '/admin/appwrite/upload'
  defaults:
    _form: '\Drupal\appwrite_integration\Form\FileUploadForm'
    _title: 'Upload File to Appwrite'
  requirements:
    _permission: 'administer site configuration'

appwrite_integration.file_list:
  path: '/admin/appwrite/files'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AppwriteStorageController::listFiles'
    _title: 'List Files'
  requirements:
    _permission: 'administer site configuration'

appwrite_integration.file_download:
  path: '/admin/appwrite/files/download/{file_id}'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AppwriteStorageController::downloadFile'
    _title: 'Download File'
  requirements:
    _permission: 'administer site configuration'

appwrite_integration.file_delete:
  path: '/admin/appwrite/files/delete/{file_id}'
  defaults:
    _controller: '\Drupal\appwrite_integration\Controller\AppwriteStorageController::deleteFile'
    _title: 'Delete File'
  requirements:
    _permission: 'administer site configuration'

appwrite_integration.bulk_delete:
  path: '/admin/appwrite/files/delete'
  defaults:
    _form: '\Drupal\appwrite_integration\Form\AppwriteFileDeleteForm'
    _title: 'Delete Appwrite Files'
  requirements:
    _permission: 'administer site configuration'
